"use strict";define(["app","app.config"],function(e,t){e.directive("fileUploader",["$timeout","$window","$parse",function(e,n,i){return{restrict:"E",templateUrl:"js/directive/file-uploader/template.html",link:function(e,r,s,a){e.running=!1,e.process="上传中...",e.selectedFile=null;var l=r.find("#file").get(0),o=new XMLHttpRequest,u=i(s.oncomplete);o.addEventListener("readystatechange",function(){4==this.readyState&&200==this.status&&(e.running=!1,e.$apply(),u(e,{$result:JSON.parse(this.responseText)}))},!1),e.sendFile=function(){if(l.files.length<=0)return void n.alert("请选择文件");e.running=!0;var i=new FormData;o.open("POST",t.importStudentUri,!0),o.setRequestHeader("user-authorize",e.sessionStorage.token),i.append("file",l.files[0]),o.send(i)}}}}])});